<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>Hidexx æ¶æ„å›¾</title>
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<style>
  body { background: #0d1117; color: #e6edf3; font-family: -apple-system, sans-serif; padding: 40px; }
  h1 { text-align: center; font-size: 28px; margin-bottom: 8px; }
  h2 { text-align: center; font-size: 16px; color: #8b949e; font-weight: normal; margin-bottom: 40px; }
  .diagram { display: flex; justify-content: center; margin-bottom: 50px; }
  .section-title { font-size: 20px; margin: 40px 0 20px; border-bottom: 1px solid #30363d; padding-bottom: 8px; }
</style>
</head>
<body>

<h1>Hidexx è‡ªåŠ¨ç™½å«–ä»£ç†ç³»ç»Ÿ</h1>
<h2>æ¯å¤©è‡ªåŠ¨æ³¨å†Œ â†’ OCR ç ´è§£éªŒè¯ç  â†’ é¢†å–è¯•ç”¨ â†’ åˆ†å‘è®¢é˜…ï¼Œæ‰‹æœºé…ä¸€æ¬¡æ°¸ä¹…æœ‰æ•ˆ</h2>

<div class="section-title">ğŸ—ï¸ ç³»ç»Ÿæ¶æ„</div>
<div class="diagram">
<pre class="mermaid">
graph TB
    subgraph HIDEXX["ğŸ–¥ï¸ Mac Â· hidexx serve :51991"]
        direction TB
        CRON["â° å®šæ—¶å™¨<br/>æ¯ 20 å°æ—¶è§¦å‘"]
        REG["ğŸ“ æ³¨å†Œæ¨¡å—<br/>éšæœºé‚®ç®± + å¯†ç "]
        OCR["ğŸ” OCR æ¨¡å—<br/>tesseract è¯†åˆ«éªŒè¯ç <br/>å¤±è´¥è‡ªåŠ¨é‡è¯•"]
        CLAIM["ğŸ é¢†å–æ¨¡å—<br/>è§£æ sid/checksum<br/>POST é¢†å–å…è´¹è¯•ç”¨"]
        FETCH["ğŸ“¥ è®¢é˜…æ‹‰å–<br/>ä¸‹è½½ Clash YAML â‰ˆ38KB"]
        STORE["ğŸ’¾ å†…å­˜å­˜å‚¨<br/>æœ€æ–°èŠ‚ç‚¹é…ç½®"]
        HTTP["ğŸŒ HTTP Server<br/>GET /sub.yaml"]

        CRON --> REG --> OCR --> CLAIM --> FETCH --> STORE --> HTTP
    end

    SITE["â˜ï¸ a.hidexx.com<br/>ä»£ç†èŠ‚ç‚¹æä¾›å•†"]
    SUB_SITE["â˜ï¸ sub.51trojan.com<br/>è®¢é˜…é…ç½®æœåŠ¡"]

    REG -- "POST /users/register" --> SITE
    OCR -- "GET /users/vcode" --> SITE
    CLAIM -- "POST /orders/request_day_trial" --> SITE
    FETCH -- "GET /v1/sub/.../xxx.yaml" --> SUB_SITE

    IPHONE["ğŸ“± iPhone<br/>Shadowrocket"]
    IPAD["ğŸ“± iPad<br/>Clash"]
    FRIEND["ğŸ“± æœ‹å‹çš„æ‰‹æœº<br/>ä»»æ„å®¢æˆ·ç«¯"]

    HTTP -- "http://192.168.x.x:51991/sub.yaml" --> IPHONE
    HTTP -- "åŒä¸€ WiFi" --> IPAD
    HTTP -- "åŒä¸€ WiFi" --> FRIEND

    style HIDEXX fill:#161b22,stroke:#58a6ff,stroke-width:2px,color:#e6edf3
    style SITE fill:#1a1e24,stroke:#f97583,stroke-width:1px,color:#e6edf3
    style SUB_SITE fill:#1a1e24,stroke:#f97583,stroke-width:1px,color:#e6edf3
    style IPHONE fill:#1a1e24,stroke:#56d364,stroke-width:2px,color:#e6edf3
    style IPAD fill:#1a1e24,stroke:#56d364,stroke-width:1px,color:#e6edf3
    style FRIEND fill:#1a1e24,stroke:#56d364,stroke-width:1px,color:#e6edf3
    style CRON fill:#21262d,stroke:#8b949e,color:#e6edf3
    style REG fill:#21262d,stroke:#8b949e,color:#e6edf3
    style OCR fill:#21262d,stroke:#d29922,color:#e6edf3
    style CLAIM fill:#21262d,stroke:#8b949e,color:#e6edf3
    style FETCH fill:#21262d,stroke:#8b949e,color:#e6edf3
    style STORE fill:#21262d,stroke:#58a6ff,color:#e6edf3
    style HTTP fill:#21262d,stroke:#58a6ff,color:#e6edf3
</pre>
</div>

<div class="section-title">ğŸ”„ æ¯æ—¥è‡ªåŠ¨ç»­å‘½æµç¨‹</div>
<div class="diagram">
<pre class="mermaid">
sequenceDiagram
    participant T as â° å®šæ—¶å™¨
    participant H as ğŸ–¥ï¸ hidexx
    participant S as â˜ï¸ hidexx.com
    participant O as ğŸ” tesseract
    participant Sub as â˜ï¸ è®¢é˜…æœåŠ¡
    participant P as ğŸ“± æ‰‹æœº

    T->>H: è§¦å‘ (æ¯20h)

    Note over H: ç”Ÿæˆéšæœºé‚®ç®±+å¯†ç 

    H->>S: GET /users/vcode
    S-->>H: éªŒè¯ç å›¾ç‰‡ (PNG)

    H->>O: OCR è¯†åˆ«
    O-->>H: "T4K6" (4ä½å­—ç¬¦)

    alt OCR ç»“æœä¸æ˜¯4ä½
        H->>S: é‡æ–° GET /users/vcode
        Note over H,O: é‡è¯•ï¼Œæœ€å¤š10æ¬¡
    end

    H->>S: POST /users/register (email + pass + éªŒè¯ç )
    S-->>H: 302 â†’ /users/ucenter (æ³¨å†ŒæˆåŠŸï¼Œè‡ªåŠ¨ç™»å½•)

    H->>S: GET /users/ucenter
    S-->>H: HTML (å« sid + checksum)

    H->>S: POST /orders/request_day_trial (sid + checksum + line_id)
    S-->>H: é¢†å–æˆåŠŸï¼

    H->>S: GET /users/ucenter
    S-->>H: HTML (å« copyText è®¢é˜…URL)

    H->>Sub: GET /v1/sub/{sid}/{token}.yaml
    Sub-->>H: Clash èŠ‚ç‚¹é…ç½® YAML (â‰ˆ38KB)

    Note over H: å­˜å…¥å†…å­˜ï¼Œç­‰å¾…æ‰‹æœºè¯·æ±‚

    P->>H: GET /sub.yaml
    H-->>P: è¿”å›æœ€æ–°èŠ‚ç‚¹é…ç½®

    Note over P: Shadowrocket è‡ªåŠ¨æ›´æ–°èŠ‚ç‚¹ âœ…
</pre>
</div>

<div class="section-title">ğŸ“Š å¯¹æ¯”ï¼šæ‰‹åŠ¨ vs è‡ªåŠ¨</div>
<div class="diagram">
<pre class="mermaid">
graph LR
    subgraph BEFORE["ğŸ˜µ ä»¥å‰ Â· æ¯å¤©æ‰‹åŠ¨"]
        direction TB
        B1["æ‰“å¼€ç½‘ç«™"] --> B2["æ³¨å†Œæ–°è´¦å·"]
        B2 --> B3["è¾“å…¥éªŒè¯ç "]
        B3 --> B4["ç‚¹å‡»é¢†å–"]
        B4 --> B5["å¤åˆ¶è®¢é˜…é“¾æ¥"]
        B5 --> B6["æ‰“å¼€æ‰‹æœº App"]
        B6 --> B7["ç²˜è´´é…ç½®"]
        B7 --> B8["Ã—365å¤© ğŸ¤¯"]
    end

    subgraph AFTER["ğŸ˜ ç°åœ¨ Â· å…¨è‡ªåŠ¨"]
        direction TB
        A1["Mac å¼€æœº"] --> A2["hidexx serve è‡ªåŠ¨å¯åŠ¨"]
        A2 --> A3["è‡ªåŠ¨æ³¨å†Œ+OCR+é¢†å–"]
        A3 --> A4["HTTP åˆ†å‘é…ç½®"]
        A4 --> A5["æ‰‹æœºè‡ªåŠ¨æ‹‰å–"]
        A5 --> A6["äººå·¥æ“ä½œ = 0 ğŸ‰"]
    end

    style BEFORE fill:#1a1e24,stroke:#f97583,stroke-width:2px,color:#e6edf3
    style AFTER fill:#1a1e24,stroke:#56d364,stroke-width:2px,color:#e6edf3
    style B8 fill:#3d1f1f,stroke:#f97583,color:#f97583
    style A6 fill:#1a3a1a,stroke:#56d364,color:#56d364
</pre>
</div>

<script>
mermaid.initialize({
  startOnLoad: true,
  theme: 'dark',
  themeVariables: {
    darkMode: true,
    background: '#0d1117',
    primaryColor: '#21262d',
    primaryTextColor: '#e6edf3',
    primaryBorderColor: '#58a6ff',
    lineColor: '#8b949e',
    secondaryColor: '#161b22',
    tertiaryColor: '#1a1e24',
    noteBkgColor: '#161b22',
    noteTextColor: '#e6edf3',
    noteBorderColor: '#30363d',
    actorBkg: '#21262d',
    actorTextColor: '#e6edf3',
    actorBorder: '#58a6ff',
    signalColor: '#8b949e',
    labelBoxBkgColor: '#21262d',
    labelBoxBorderColor: '#30363d',
    labelTextColor: '#e6edf3',
  },
  flowchart: { curve: 'basis', padding: 20 },
  sequence: { mirrorActors: false, messageMargin: 40 }
});
</script>

</body>
</html>
